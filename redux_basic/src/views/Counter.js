/** * Created by wangxiaoyu on 2017/8/18. */import React , { Component,PropTypes } from  'react';import * as Actions from '../Actions';import store from '../Store';const buttonStyle = {    margin: '10px'};class Counter extends Component {    render(){        const { caption,onClickIncrementButton,onClickDecrementButton,value} = this.props;        return(            <div>                <button style={buttonStyle} onClick={onClickIncrementButton}>+</button>                <button style={buttonStyle} onClick={onClickDecrementButton}>-</button>                <span>{caption} count: {value}</span>            </div>        )    }}class CounterContainer extends Component {    constructor(props){        super(props);        this.onChange = this.onChange.bind(this);        this.onClickIncrementButton = this.onClickIncrementButton.bind(this);        this.onClickDecrementButton = this.onClickDecrementButton.bind(this);        this.state = this.getOwnState();    }    getOwnState(){        return {            value:store.getState()[this.props.caption]        }    }    shouldComponentUpdate(nextProps,nextState){        return (nextProps.caption !== this.props.caption) ||                (nextState.value !== this.state.value)    }    componentDidMount(){        store.subscribe(this.onChange)    }    componentWillUnmount(){        store.unsubscribe(this.onChange)    }    onChange(){        this.setState(this.getOwnState());    }    onClickIncrementButton(){        store.dispatch(Actions.increment(this.props.caption));    }    onClickDecrementButton(){        store.dispatch(Actions.decrement(this.props.caption));    }    render(){        const value = this.state.value;        const {caption} = this.props;        return(          <Counter caption={this.props.caption}                   onClickIncrementButton={this.onClickIncrementButton}                   onClickDecrementButton={this.onClickDecrementButton}                   value={this.state.value}/>        )    }}// Counter.propTypes = {//     caption:PropTypes.string.isRequired// };export default CounterContainer;